(function(c,a){c.version="0.9.6";c.protocol=1;c.transports=[];c.j=[];c.sockets={};c.connect=function(b,d){var e=c.util.parseUri(b),f,h;a&&a.location&&(e.protocol=e.protocol||a.location.protocol.slice(0,-1),e.host=e.host||(a.document?a.document.domain:a.location.hostname),e.port=e.port||a.location.port);f=c.util.uniqueUri(e);var g={host:e.host,secure:"https"==e.protocol,port:e.port||("https"==e.protocol?443:80),query:e.query||""};c.util.merge(g,d);if(g["force new connection"]||!c.sockets[f])h=new c.Socket(g);
!g["force new connection"]&&h&&(c.sockets[f]=h);h=h||c.sockets[f];return h.of(1<e.path.length?e.path:"")}})("object"===typeof module?module.exports:this.io={},this);
(function(c,a){var b=c.util={},d=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,e="source,protocol,authority,userInfo,user,password,host,port,relative,path,directory,file,query,anchor".split(",");b.parseUri=function(a){for(var a=d.exec(a||""),g={},b=14;b--;)g[e[b]]=a[b]||"";return g};b.uniqueUri=function(d){var g=d.protocol,b=d.host,d=d.port;"document"in
a?(b=b||document.domain,d=d||("https"==g&&"https:"!==document.location.protocol?443:document.location.port)):(b=b||"localhost",!d&&"https"==g&&(d=443));return(g||"http")+"://"+b+":"+(d||80)};b.query=function(a,d){var c=b.chunkQuery(a||""),f=[];b.merge(c,b.chunkQuery(d||""));for(var e in c)c.hasOwnProperty(e)&&f.push(e+"="+c[e]);return f.length?"?"+f.join("&"):""};b.chunkQuery=function(a){for(var d={},a=a.split("&"),b=0,c=a.length,f;b<c;++b)f=a[b].split("="),f[0]&&(d[f[0]]=f[1]);return d};var f=!1;
b.load=function(d){if("document"in a&&"complete"===document.readyState||f)return d();b.on(a,"load",d,!1)};b.on=function(a,d,b,c){a.attachEvent?a.attachEvent("on"+d,b):a.addEventListener&&a.addEventListener(d,b,c)};b.request=function(a){if(a&&"undefined"!=typeof XDomainRequest)return new XDomainRequest;if("undefined"!=typeof XMLHttpRequest&&(!a||b.ua.hasCORS))return new XMLHttpRequest;if(!a)try{return new (window[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(d){}return null};"undefined"!=
typeof window&&b.load(function(){f=!0});b.defer=function(a){if(!b.ua.webkit||"undefined"!=typeof importScripts)return a();b.load(function(){setTimeout(a,100)})};b.merge=function(a,d,c,f){var f=f||[],c="undefined"==typeof c?2:c,e;for(e in d)d.hasOwnProperty(e)&&0>b.indexOf(f,e)&&("object"!==typeof a[e]||!c?(a[e]=d[e],f.push(d[e])):b.merge(a[e],d[e],c-1,f));return a};b.mixin=function(a,d){b.merge(a.prototype,d.prototype)};b.inherit=function(a,d){function b(){}b.prototype=d.prototype;a.prototype=new b};
b.isArray=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)};b.intersect=function(a,d){for(var c=[],f=a.length>d.length?a:d,e=a.length>d.length?d:a,j=0,s=e.length;j<s;j++)~b.indexOf(f,e[j])&&c.push(e[j]);return c};b.indexOf=function(a,d,b){for(var c=a.length,b=0>b?0>b+c?0:b+c:b||0;b<c&&a[b]!==d;b++);return c<=b?-1:b};b.toArray=function(a){for(var d=[],b=0,c=a.length;b<c;b++)d.push(a[b]);return d};b.ua={};b.ua.hasCORS="undefined"!=typeof XMLHttpRequest&&function(){try{var a=
new XMLHttpRequest}catch(d){return!1}return void 0!=a.withCredentials}();b.ua.webkit="undefined"!=typeof navigator&&/webkit/i.test(navigator.userAgent)})("undefined"!=typeof io?io:module.exports,this);
(function(c,a){function b(){}c.EventEmitter=b;b.prototype.on=function(d,b){this.$events||(this.$events={});this.$events[d]?a.util.isArray(this.$events[d])?this.$events[d].push(b):this.$events[d]=[this.$events[d],b]:this.$events[d]=b;return this};b.prototype.addListener=b.prototype.on;b.prototype.once=function(a,b){function c(){h.removeListener(a,c);b.apply(this,arguments)}var h=this;c.listener=b;this.on(a,c);return this};b.prototype.removeListener=function(d,b){if(this.$events&&this.$events[d]){var c=
this.$events[d];if(a.util.isArray(c)){for(var h=-1,g=0,i=c.length;g<i;g++)if(c[g]===b||c[g].listener&&c[g].listener===b){h=g;break}if(0>h)return this;c.splice(h,1);c.length||delete this.$events[d]}else(c===b||c.listener&&c.listener===b)&&delete this.$events[d]}return this};b.prototype.removeAllListeners=function(a){this.$events&&this.$events[a]&&(this.$events[a]=null);return this};b.prototype.listeners=function(d){this.$events||(this.$events={});this.$events[d]||(this.$events[d]=[]);a.util.isArray(this.$events[d])||
(this.$events[d]=[this.$events[d]]);return this.$events[d]};b.prototype.emit=function(d){if(!this.$events)return!1;var b=this.$events[d];if(!b)return!1;var c=Array.prototype.slice.call(arguments,1);if("function"==typeof b)b.apply(this,c);else if(a.util.isArray(b))for(var b=b.slice(),h=0,g=b.length;h<g;h++)b[h].apply(this,c);else return!1;return!0}})("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports);
(function(c,a){function b(a){return 10>a?"0"+a:a}function d(a){g.lastIndex=0;return g.test(a)?'"'+a.replace(g,function(a){var d=l[a];return"string"===typeof d?d:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function e(a,c){var g,f,h,l,p=i,r,q=c[a];q instanceof Date&&(q=isFinite(a.valueOf())?a.getUTCFullYear()+"-"+b(a.getUTCMonth()+1)+"-"+b(a.getUTCDate())+"T"+b(a.getUTCHours())+":"+b(a.getUTCMinutes())+":"+b(a.getUTCSeconds())+"Z":null);"function"===typeof j&&(q=j.call(c,a,
q));switch(typeof q){case "string":return d(q);case "number":return isFinite(q)?""+q:"null";case "boolean":case "null":return""+q;case "object":if(!q)return"null";i+=n;r=[];if("[object Array]"===Object.prototype.toString.apply(q)){l=q.length;for(g=0;g<l;g+=1)r[g]=e(g,q)||"null";h=0===r.length?"[]":i?"[\n"+i+r.join(",\n"+i)+"\n"+p+"]":"["+r.join(",")+"]";i=p;return h}if(j&&"object"===typeof j){l=j.length;for(g=0;g<l;g+=1)"string"===typeof j[g]&&(f=j[g],(h=e(f,q))&&r.push(d(f)+(i?": ":":")+h))}else for(f in q)Object.prototype.hasOwnProperty.call(q,
f)&&(h=e(f,q))&&r.push(d(f)+(i?": ":":")+h);h=0===r.length?"{}":i?"{\n"+i+r.join(",\n"+i)+"\n"+p+"}":"{"+r.join(",")+"}";i=p;return h}}if(a&&a.parse)return c.JSON={parse:a.parse,stringify:a.stringify};var f=c.JSON={},h=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,g=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,i,n,l={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f",
"\r":"\\r",'"':'\\"',"\\":"\\\\"},j;f.stringify=function(a,d,b){var g;n=i="";if("number"===typeof b)for(g=0;g<b;g+=1)n+=" ";else"string"===typeof b&&(n=b);if((j=d)&&"function"!==typeof d&&("object"!==typeof d||"number"!==typeof d.length))throw Error("JSON.stringify");return e("",{"":a})};f.parse=function(a,d){function b(a,g){var c,f,e=a[g];if(e&&"object"===typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(f=b(e,c),void 0!==f?e[c]=f:delete e[c]);return d.call(a,g,e)}var g,a=""+a;h.lastIndex=
0;h.test(a)&&(a=a.replace(h,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return g=eval("("+a+")"),"function"===typeof d?b({"":g},""):g;throw new SyntaxError("JSON.parse");}})("undefined"!=typeof io?io:module.exports,"undefined"!==typeof JSON?JSON:void 0);
(function(c,a){var b=c.parser={},d=b.packets="disconnect,connect,heartbeat,message,json,event,ack,error,noop".split(","),e=b.reasons=["transport not supported","client not handshaken","unauthorized"],f=b.advice=["reconnect"],h=a.JSON,g=a.util.indexOf;b.encodePacket=function(a){var b=g(d,a.type),c=a.id||"",i=a.endpoint||"",o=a.ack,t=null;switch(a.type){case "error":var A=a.reason?g(e,a.reason):"",a=a.advice?g(f,a.advice):"";if(""!==A||""!==a)t=A+(""!==a?"+"+a:"");break;case "message":""!==a.data&&
(t=a.data);break;case "event":t={name:a.name};a.args&&a.args.length&&(t.args=a.args);t=h.stringify(t);break;case "json":t=h.stringify(a.data);break;case "connect":a.qs&&(t=a.qs);break;case "ack":t=a.ackId+(a.args&&a.args.length?"+"+h.stringify(a.args):"")}b=[b,c+("data"==o?"+":""),i];null!==t&&void 0!==t&&b.push(t);return b.join(":")};b.encodePayload=function(a){var d="";if(1==a.length)return a[0];for(var b=0,g=a.length;b<g;b++)d+="\ufffd"+a[b].length+"\ufffd"+a[b];return d};var i=/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/;
b.decodePacket=function(a){var b=a.match(i);if(!b)return{};var g=b[2]||"",a=b[5]||"",c={type:d[b[1]],endpoint:b[4]||""};g&&(c.id=g,c.ack=b[3]?"data":!0);switch(c.type){case "error":b=a.split("+");c.reason=e[b[0]]||"";c.advice=f[b[1]]||"";break;case "message":c.data=a||"";break;case "event":try{var o=h.parse(a);c.name=o.name;c.args=o.args}catch(t){}c.args=c.args||[];break;case "json":try{c.data=h.parse(a)}catch(A){}break;case "connect":c.qs=a||"";break;case "ack":if(b=a.match(/^([0-9]+)(\+)?(.*)/))if(c.ackId=
b[1],c.args=[],b[3])try{c.args=b[3]?h.parse(b[3]):[]}catch(w){}}return c};b.decodePayload=function(a){if("\ufffd"==a.charAt(0)){for(var d=[],g=1,c="";g<a.length;g++)"\ufffd"==a.charAt(g)?(d.push(b.decodePacket(a.substr(g+1).substr(0,c))),g+=Number(c)+1,c=""):c+=a.charAt(g);return d}return[b.decodePacket(a)]}})("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports);
(function(c,a){function b(a,b){this.socket=a;this.sessid=b}c.Transport=b;a.util.mixin(b,a.EventEmitter);b.prototype.onData=function(d){this.clearCloseTimeout();(this.socket.connected||this.socket.connecting||this.socket.reconnecting)&&this.setCloseTimeout();if(""!==d&&(d=a.parser.decodePayload(d))&&d.length)for(var b=0,c=d.length;b<c;b++)this.onPacket(d[b]);return this};b.prototype.onPacket=function(a){this.socket.setHeartbeatTimeout();if("heartbeat"==a.type)return this.onHeartbeat();if("connect"==
a.type&&""==a.endpoint)this.onConnect();"error"==a.type&&"reconnect"==a.advice&&(this.open=!1);this.socket.onPacket(a);return this};b.prototype.setCloseTimeout=function(){if(!this.closeTimeout){var a=this;this.closeTimeout=setTimeout(function(){a.onDisconnect()},this.socket.closeTimeout)}};b.prototype.onDisconnect=function(){this.close&&this.open&&this.close();this.clearTimeouts();this.socket.onDisconnect();return this};b.prototype.onConnect=function(){this.socket.onConnect();return this};b.prototype.clearCloseTimeout=
function(){this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=null)};b.prototype.clearTimeouts=function(){this.clearCloseTimeout();this.reopenTimeout&&clearTimeout(this.reopenTimeout)};b.prototype.packet=function(d){this.send(a.parser.encodePacket(d))};b.prototype.onHeartbeat=function(){this.packet({type:"heartbeat"})};b.prototype.onOpen=function(){this.open=!0;this.clearCloseTimeout();this.socket.onOpen()};b.prototype.onClose=function(){this.open=!1;this.socket.onClose();this.onDisconnect()};
b.prototype.prepareUrl=function(){var d=this.socket.options;return this.scheme()+"://"+d.host+":"+d.port+"/"+d.resource+"/"+a.protocol+"/"+this.name+"/"+this.sessid};b.prototype.ready=function(a,b){b.call(this)}})("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports);
(function(c,a,b){function d(d){this.options={port:80,secure:!1,document:"document"in b?document:!1,resource:"socket.io",transports:a.transports,"connect timeout":1E4,"try multiple transports":!0,reconnect:!0,"reconnection delay":500,"reconnection limit":Infinity,"reopen delay":3E3,"max reconnection attempts":10,"sync disconnect on unload":!0,"auto connect":!0,"flash policy port":10843};a.util.merge(this.options,d);this.reconnecting=this.connecting=this.open=this.connected=!1;this.namespaces={};this.buffer=
[];this.doBuffer=!1;if(this.options["sync disconnect on unload"]&&(!this.isXDomain()||a.util.ua.hasCORS)){var c=this;a.util.on(b,"unload",function(){c.disconnectSync()},!1)}this.options["auto connect"]&&this.connect()}function e(){}c.Socket=d;a.util.mixin(d,a.EventEmitter);d.prototype.of=function(d){this.namespaces[d]||(this.namespaces[d]=new a.SocketNamespace(this,d),""!==d&&this.namespaces[d].packet({type:"connect"}));return this.namespaces[d]};d.prototype.publish=function(){this.emit.apply(this,
arguments);var a,d;for(d in this.namespaces)this.namespaces.hasOwnProperty(d)&&(a=this.of(d),a.$emit.apply(a,arguments))};d.prototype.handshake=function(d){function b(a){if(a instanceof Error)c.onError(a.message);else d.apply(null,a.split(":"))}var c=this,i=this.options,i=["http"+(i.secure?"s":"")+":/",i.host+":"+i.port,i.resource,a.protocol,a.util.query(this.options.query,"t="+ +new Date)].join("/");if(this.isXDomain()&&!a.util.ua.hasCORS){var n=document.getElementsByTagName("script")[0],l=document.createElement("script");
l.src=i+"&jsonp="+a.j.length;n.parentNode.insertBefore(l,n);a.j.push(function(a){b(a);l.parentNode.removeChild(l)})}else{var j=a.util.request();j.open("GET",i,!0);j.withCredentials=!0;j.onreadystatechange=function(){4==j.readyState&&(j.onreadystatechange=e,200==j.status?b(j.responseText):!c.reconnecting&&c.onError(j.responseText))};j.send(null)}};d.prototype.getTransport=function(d){for(var d=d||this.transports,b=0,c;c=d[b];b++)if(a.Transport[c]&&a.Transport[c].check(this)&&(!this.isXDomain()||a.Transport[c].xdomainCheck()))return new a.Transport[c](this,
this.sessionid);return null};d.prototype.connect=function(d){if(this.connecting)return this;var b=this;this.handshake(function(c,e,n,l){function j(a){b.transport&&b.transport.clearTimeouts();b.transport=b.getTransport(a);if(!b.transport)return b.publish("connect_failed");b.transport.ready(b,function(){b.connecting=!0;b.publish("connecting",b.transport.name);b.transport.open();b.options["connect timeout"]&&(b.connectTimeoutTimer=setTimeout(function(){if(!b.connected&&(b.connecting=!1,b.options["try multiple transports"])){b.remainingTransports||
(b.remainingTransports=b.transports.slice(0));for(var a=b.remainingTransports;0<a.length&&a.splice(0,1)[0]!=b.transport.name;);a.length?j(a):b.publish("connect_failed")}},b.options["connect timeout"]))})}b.sessionid=c;b.closeTimeout=1E3*n;b.heartbeatTimeout=1E3*e;b.transports=l?a.util.intersect(l.split(","),b.options.transports):b.options.transports;b.setHeartbeatTimeout();j(b.transports);b.once("connect",function(){clearTimeout(b.connectTimeoutTimer);d&&"function"==typeof d&&d()})});return this};
d.prototype.setHeartbeatTimeout=function(){clearTimeout(this.heartbeatTimeoutTimer);var a=this;this.heartbeatTimeoutTimer=setTimeout(function(){a.transport.onClose()},this.heartbeatTimeout)};d.prototype.packet=function(a){this.connected&&!this.doBuffer?this.transport.packet(a):this.buffer.push(a);return this};d.prototype.setBuffer=function(a){this.doBuffer=a;!a&&this.connected&&this.buffer.length&&(this.transport.payload(this.buffer),this.buffer=[])};d.prototype.disconnect=function(){if(this.connected||
this.connecting)this.open&&this.of("").packet({type:"disconnect"}),this.onDisconnect("booted");return this};d.prototype.disconnectSync=function(){a.util.request().open("GET",this.resource+"/"+a.protocol+"/"+this.sessionid,!0);this.onDisconnect("booted")};d.prototype.isXDomain=function(){var a=b.location.port||("https:"==b.location.protocol?443:80);return this.options.host!==b.location.hostname||this.options.port!=a};d.prototype.onConnect=function(){this.connected||(this.connected=!0,this.connecting=
!1,this.doBuffer||this.setBuffer(!1),this.emit("connect"))};d.prototype.onOpen=function(){this.open=!0};d.prototype.onClose=function(){this.open=!1;clearTimeout(this.heartbeatTimeoutTimer)};d.prototype.onPacket=function(a){this.of(a.endpoint).onPacket(a)};d.prototype.onError=function(a){if(a&&a.advice&&"reconnect"===a.advice&&(this.connected||this.connecting))this.disconnect(),this.options.reconnect&&this.reconnect();this.publish("error",a&&a.reason?a.reason:a)};d.prototype.onDisconnect=function(a){var d=
this.connected,b=this.connecting;this.open=this.connecting=this.connected=!1;if(d||b)this.transport.close(),this.transport.clearTimeouts(),d&&(this.publish("disconnect",a),"booted"!=a&&this.options.reconnect&&!this.reconnecting&&this.reconnect())};d.prototype.reconnect=function(){function a(){if(b.connected){for(var c in b.namespaces)b.namespaces.hasOwnProperty(c)&&""!==c&&b.namespaces[c].packet({type:"connect"});b.publish("reconnect",b.transport.name,b.reconnectionAttempts)}clearTimeout(b.reconnectionTimer);
b.removeListener("connect_failed",d);b.removeListener("connect",d);b.reconnecting=!1;delete b.reconnectionAttempts;delete b.reconnectionDelay;delete b.reconnectionTimer;delete b.redoTransports;b.options["try multiple transports"]=e}function d(){if(b.reconnecting){if(b.connected)return a();if(b.connecting&&b.reconnecting)return b.reconnectionTimer=setTimeout(d,1E3);b.reconnectionAttempts++>=c?b.redoTransports?(b.publish("reconnect_failed"),a()):(b.on("connect_failed",d),b.options["try multiple transports"]=
!0,b.transport=b.getTransport(),b.redoTransports=!0,b.connect()):(b.reconnectionDelay<l&&(b.reconnectionDelay*=2),b.connect(),b.publish("reconnecting",b.reconnectionDelay,b.reconnectionAttempts),b.reconnectionTimer=setTimeout(d,b.reconnectionDelay))}}this.reconnecting=!0;this.reconnectionAttempts=0;this.reconnectionDelay=this.options["reconnection delay"];var b=this,c=this.options["max reconnection attempts"],e=this.options["try multiple transports"],l=this.options["reconnection limit"];this.options["try multiple transports"]=
!1;this.reconnectionTimer=setTimeout(d,this.reconnectionDelay);this.on("connect",d)}})("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports,this);
(function(c,a){function b(a,b){this.socket=a;this.name=b||"";this.flags={};this.json=new d(this,"json");this.ackPackets=0;this.acks={}}function d(a,b){this.namespace=a;this.name=b}c.SocketNamespace=b;a.util.mixin(b,a.EventEmitter);b.prototype.$emit=a.EventEmitter.prototype.emit;b.prototype.of=function(){return this.socket.of.apply(this.socket,arguments)};b.prototype.packet=function(a){a.endpoint=this.name;this.socket.packet(a);this.flags={};return this};b.prototype.send=function(a,b){var d={type:this.flags.json?
"json":"message",data:a};"function"==typeof b&&(d.id=++this.ackPackets,d.ack=!0,this.acks[d.id]=b);return this.packet(d)};b.prototype.emit=function(a){var b=Array.prototype.slice.call(arguments,1),d=b[b.length-1],c={type:"event",name:a};"function"==typeof d&&(c.id=++this.ackPackets,c.ack="data",this.acks[c.id]=d,b=b.slice(0,b.length-1));c.args=b;return this.packet(c)};b.prototype.disconnect=function(){""===this.name?this.socket.disconnect():(this.packet({type:"disconnect"}),this.$emit("disconnect"));
return this};b.prototype.onPacket=function(b){function d(){c.packet({type:"ack",args:a.util.toArray(arguments),ackId:b.id})}var c=this;switch(b.type){case "connect":this.$emit("connect");break;case "disconnect":if(""===this.name)this.socket.onDisconnect(b.reason||"booted");else this.$emit("disconnect",b.reason);break;case "message":case "json":var g=["message",b.data];"data"==b.ack?g.push(d):b.ack&&this.packet({type:"ack",ackId:b.id});this.$emit.apply(this,g);break;case "event":g=[b.name].concat(b.args);
"data"==b.ack&&g.push(d);this.$emit.apply(this,g);break;case "ack":this.acks[b.ackId]&&(this.acks[b.ackId].apply(this,b.args),delete this.acks[b.ackId]);break;case "error":if(b.advice)this.socket.onError(b);else"unauthorized"==b.reason?this.$emit("connect_failed",b.reason):this.$emit("error",b.reason)}};d.prototype.send=function(){this.namespace.flags[this.name]=!0;this.namespace.send.apply(this.namespace,arguments)};d.prototype.emit=function(){this.namespace.flags[this.name]=!0;this.namespace.emit.apply(this.namespace,
arguments)}})("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports);
(function(c,a,b){function d(b){a.Transport.apply(this,arguments)}c.websocket=d;a.util.inherit(d,a.Transport);d.prototype.name="websocket";d.prototype.open=function(){var d=a.util.query(this.socket.options.query),c=this,h;h||(h=b.MozWebSocket||b.WebSocket);this.websocket=new h(this.prepareUrl()+d);this.websocket.onopen=function(){c.onOpen();c.socket.setBuffer(!1)};this.websocket.onmessage=function(a){c.onData(a.data)};this.websocket.onclose=function(){c.onClose();c.socket.setBuffer(!0)};this.websocket.onerror=
function(a){c.onError(a)};return this};d.prototype.send=function(a){this.websocket.send(a);return this};d.prototype.payload=function(a){for(var b=0,d=a.length;b<d;b++)this.packet(a[b]);return this};d.prototype.close=function(){this.websocket.close();return this};d.prototype.onError=function(a){this.socket.onError(a)};d.prototype.scheme=function(){return this.socket.options.secure?"wss":"ws"};d.check=function(){return"WebSocket"in b&&!("__addTask"in WebSocket)||"MozWebSocket"in b};d.xdomainCheck=function(){return!0};
a.transports.push("websocket")})("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this);
(function(c,a){function b(){a.Transport.websocket.apply(this,arguments)}c.flashsocket=b;a.util.inherit(b,a.Transport.websocket);b.prototype.name="flashsocket";b.prototype.open=function(){var b=this,c=arguments;WebSocket.__addTask(function(){a.Transport.websocket.prototype.open.apply(b,c)});return this};b.prototype.send=function(){var b=this,c=arguments;WebSocket.__addTask(function(){a.Transport.websocket.prototype.send.apply(b,c)});return this};b.prototype.close=function(){WebSocket.__tasks.length=
0;a.Transport.websocket.prototype.close.call(this);return this};b.prototype.ready=function(d,c){function f(){var a=d.options,f=a["flash policy port"],n=["http"+(a.secure?"s":"")+":/",a.host+":"+a.port,a.resource,"static/flashsocket","WebSocketMain"+(d.isXDomain()?"Insecure":"")+".swf"];b.loaded||("undefined"===typeof WEB_SOCKET_SWF_LOCATION&&(WEB_SOCKET_SWF_LOCATION=n.join("/")),843!==f&&WebSocket.loadFlashPolicyFile("xmlsocket://"+a.host+":"+f),WebSocket.__initialize(),b.loaded=!0);c.call(h)}var h=
this;if(document.body)return f();a.util.load(f)};b.check=function(){return"undefined"==typeof WebSocket||!("__initialize"in WebSocket)||!swfobject?!1:10<=swfobject.getFlashPlayerVersion().major};b.xdomainCheck=function(){return!0};"undefined"!=typeof window&&(WEB_SOCKET_DISABLE_AUTO_INITIALIZATION=!0);a.transports.push("flashsocket")})("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports);
if("undefined"!=typeof window)var swfobject=function(){function c(){if(!z){try{var a=m.getElementsByTagName("body")[0].appendChild(m.createElement("span"));a.parentNode.removeChild(a)}catch(b){return}z=!0;for(var a=D.length,d=0;d<a;d++)D[d]()}}function a(a){z?a():D[D.length]=a}function b(a){if(typeof u.addEventListener!=p)u.addEventListener("load",a,!1);else if(typeof m.addEventListener!=p)m.addEventListener("load",a,!1);else if(typeof u.attachEvent!=p)o(u,"onload",a);else if("function"==typeof u.onload){var b=
u.onload;u.onload=function(){b();a()}}else u.onload=a}function d(){var a=m.getElementsByTagName("body")[0],b=m.createElement(r);b.setAttribute("type",q);var d=a.appendChild(b);if(d){var c=0;(function(){if(typeof d.GetVariable!=p){var g=d.GetVariable("$version");g&&(g=g.split(" ")[1].split(","),k.pv=[parseInt(g[0],10),parseInt(g[1],10),parseInt(g[2],10)])}else if(10>c){c++;setTimeout(arguments.callee,10);return}a.removeChild(b);d=null;e()})()}else e()}function e(){var a=x.length;if(0<a)for(var b=0;b<
a;b++){var d=x[b].id,c=x[b].callbackFn,e={success:!1,id:d};if(0<k.pv[0]){var j=s(d);if(j)if(t(x[b].swfVersion)&&!(k.wk&&312>k.wk))w(d,!0),c&&(e.success=!0,e.ref=f(d),c(e));else if(x[b].expressInstall&&h()){e={};e.data=x[b].expressInstall;e.width=j.getAttribute("width")||"0";e.height=j.getAttribute("height")||"0";j.getAttribute("class")&&(e.styleclass=j.getAttribute("class"));j.getAttribute("align")&&(e.align=j.getAttribute("align"));for(var l={},j=j.getElementsByTagName("param"),n=j.length,o=0;o<
n;o++)"movie"!=j[o].getAttribute("name").toLowerCase()&&(l[j[o].getAttribute("name")]=j[o].getAttribute("value"));g(e,l,d,c)}else i(j),c&&c(e)}else if(w(d,!0),c){if((d=f(d))&&typeof d.SetVariable!=p)e.success=!0,e.ref=d;c(e)}}}function f(a){var b=null;if((a=s(a))&&"OBJECT"==a.nodeName)typeof a.SetVariable!=p?b=a:(a=a.getElementsByTagName(r)[0])&&(b=a);return b}function h(){return!E&&t("6.0.65")&&(k.win||k.mac)&&!(k.wk&&312>k.wk)}function g(a,b,d,c){E=!0;H=c||null;K={success:!1,id:d};var g=s(d);if(g){"OBJECT"==
g.nodeName?(C=n(g),F=null):(C=g,F=d);a.id=M;if(typeof a.width==p||!/%$/.test(a.width)&&310>parseInt(a.width,10))a.width="310";if(typeof a.height==p||!/%$/.test(a.height)&&137>parseInt(a.height,10))a.height="137";m.title=m.title.slice(0,47)+" - Flash Player Installation";c=k.ie&&k.win?["Active"].concat("").join("X"):"PlugIn";c="MMredirectURL="+u.location.toString().replace(/&/g,"%26")+"&MMplayerType="+c+"&MMdoctitle="+m.title;b.flashvars=typeof b.flashvars!=p?b.flashvars+("&"+c):c;k.ie&&k.win&&4!=
g.readyState&&(c=m.createElement("div"),d+="SWFObjectNew",c.setAttribute("id",d),g.parentNode.insertBefore(c,g),g.style.display="none",function(){g.readyState==4?g.parentNode.removeChild(g):setTimeout(arguments.callee,10)}());l(a,b,d)}}function i(a){if(k.ie&&k.win&&4!=a.readyState){var b=m.createElement("div");a.parentNode.insertBefore(b,a);b.parentNode.replaceChild(n(a),b);a.style.display="none";(function(){4==a.readyState?a.parentNode.removeChild(a):setTimeout(arguments.callee,10)})()}else a.parentNode.replaceChild(n(a),
a)}function n(a){var b=m.createElement("div");if(k.win&&k.ie)b.innerHTML=a.innerHTML;else if(a=a.getElementsByTagName(r)[0])if(a=a.childNodes)for(var d=a.length,c=0;c<d;c++)!(1==a[c].nodeType&&"PARAM"==a[c].nodeName)&&8!=a[c].nodeType&&b.appendChild(a[c].cloneNode(!0));return b}function l(a,b,d){var c,g=s(d);if(k.wk&&312>k.wk)return c;if(g)if(typeof a.id==p&&(a.id=d),k.ie&&k.win){var e="",f;for(f in a)a[f]!=Object.prototype[f]&&("data"==f.toLowerCase()?b.movie=a[f]:"styleclass"==f.toLowerCase()?e+=
' class="'+a[f]+'"':"classid"!=f.toLowerCase()&&(e+=" "+f+'="'+a[f]+'"'));f="";for(var j in b)b[j]!=Object.prototype[j]&&(f+='<param name="'+j+'" value="'+b[j]+'" />');g.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+e+">"+f+"</object>";G[G.length]=a.id;c=s(a.id)}else{j=m.createElement(r);j.setAttribute("type",q);for(var i in a)a[i]!=Object.prototype[i]&&("styleclass"==i.toLowerCase()?j.setAttribute("class",a[i]):"classid"!=i.toLowerCase()&&j.setAttribute(i,a[i]));for(e in b)b[e]!=
Object.prototype[e]&&"movie"!=e.toLowerCase()&&(a=j,f=e,i=b[e],d=m.createElement("param"),d.setAttribute("name",f),d.setAttribute("value",i),a.appendChild(d));g.parentNode.replaceChild(j,g);c=j}return c}function j(a){var b=s(a);b&&"OBJECT"==b.nodeName&&(k.ie&&k.win?(b.style.display="none",function(){if(4==b.readyState){var d=s(a);if(d){for(var c in d)"function"==typeof d[c]&&(d[c]=null);d.parentNode.removeChild(d)}}else setTimeout(arguments.callee,10)}()):b.parentNode.removeChild(b))}function s(a){var b=
null;try{b=m.getElementById(a)}catch(d){}return b}function o(a,b,d){a.attachEvent(b,d);B[B.length]=[a,b,d]}function t(a){var b=k.pv,a=a.split(".");a[0]=parseInt(a[0],10);a[1]=parseInt(a[1],10)||0;a[2]=parseInt(a[2],10)||0;return b[0]>a[0]||b[0]==a[0]&&b[1]>a[1]||b[0]==a[0]&&b[1]==a[1]&&b[2]>=a[2]?!0:!1}function A(a,b,d,c){if(!k.ie||!k.mac){var g=m.getElementsByTagName("head")[0];if(g){d=d&&"string"==typeof d?d:"screen";c&&(I=v=null);if(!v||I!=d)c=m.createElement("style"),c.setAttribute("type","text/css"),
c.setAttribute("media",d),v=g.appendChild(c),k.ie&&k.win&&typeof m.styleSheets!=p&&0<m.styleSheets.length&&(v=m.styleSheets[m.styleSheets.length-1]),I=d;k.ie&&k.win?v&&typeof v.addRule==r&&v.addRule(a,b):v&&typeof m.createTextNode!=p&&v.appendChild(m.createTextNode(a+" {"+b+"}"))}}}function w(a,b){if(N){var d=b?"visible":"hidden";z&&s(a)?s(a).style.visibility=d:A("#"+a,"visibility:"+d)}}function J(a){return null!=/[\\\"<>\.;]/.exec(a)&&typeof encodeURIComponent!=p?encodeURIComponent(a):a}var p="undefined",
r="object",q="application/x-shockwave-flash",M="SWFObjectExprInst",u=window,m=document,y=navigator,O=!1,D=[function(){O?d():e()}],x=[],G=[],B=[],C,F,H,K,z=!1,E=!1,v,I,N=!0,k=function(){var a=typeof m.getElementById!=p&&typeof m.getElementsByTagName!=p&&typeof m.createElement!=p,b=y.userAgent.toLowerCase(),d=y.platform.toLowerCase(),c=d?/win/.test(d):/win/.test(b),d=d?/mac/.test(d):/mac/.test(b),b=/webkit/.test(b)?parseFloat(b.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,g=!+"\v1",f=[0,0,0],e=null;
if(typeof y.plugins!=p&&typeof y.plugins["Shockwave Flash"]==r){if((e=y.plugins["Shockwave Flash"].description)&&!(typeof y.mimeTypes!=p&&y.mimeTypes[q]&&!y.mimeTypes[q].enabledPlugin))O=!0,g=!1,e=e.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),f[0]=parseInt(e.replace(/^(.*)\..*$/,"$1"),10),f[1]=parseInt(e.replace(/^.*\.(.*)\s.*$/,"$1"),10),f[2]=/[a-zA-Z]/.test(e)?parseInt(e.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}else if(typeof u[["Active"].concat("Object").join("X")]!=p)try{var j=new (window[["Active"].concat("Object").join("X")])("ShockwaveFlash.ShockwaveFlash");
if(j&&(e=j.GetVariable("$version")))g=!0,e=e.split(" ")[1].split(","),f=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10)]}catch(i){}return{w3:a,pv:f,wk:b,ie:g,win:c,mac:d}}();(function(){k.w3&&((typeof m.readyState!=p&&"complete"==m.readyState||typeof m.readyState==p&&(m.getElementsByTagName("body")[0]||m.body))&&c(),z||(typeof m.addEventListener!=p&&m.addEventListener("DOMContentLoaded",c,!1),k.ie&&k.win&&(m.attachEvent("onreadystatechange",function(){"complete"==m.readyState&&(m.detachEvent("onreadystatechange",
arguments.callee),c())}),u==top&&function(){if(!z){try{m.documentElement.doScroll("left")}catch(a){setTimeout(arguments.callee,0);return}c()}}()),k.wk&&function(){z||(/loaded|complete/.test(m.readyState)?c():setTimeout(arguments.callee,0))}(),b(c)))})();(function(){k.ie&&k.win&&window.attachEvent("onunload",function(){for(var a=B.length,b=0;b<a;b++)B[b][0].detachEvent(B[b][1],B[b][2]);a=G.length;for(b=0;b<a;b++)j(G[b]);for(var d in k)k[d]=null;k=null;for(var c in swfobject)swfobject[c]=null;swfobject=
null})})();return{registerObject:function(a,b,d,c){if(k.w3&&a&&b){var g={};g.id=a;g.swfVersion=b;g.expressInstall=d;g.callbackFn=c;x[x.length]=g;w(a,!1)}else c&&c({success:!1,id:a})},getObjectById:function(a){if(k.w3)return f(a)},embedSWF:function(b,d,c,e,f,j,i,n,s,o){var m={success:!1,id:d};k.w3&&!(k.wk&&312>k.wk)&&b&&d&&c&&e&&f?(w(d,!1),a(function(){c+="";e+="";var a={};if(s&&typeof s===r)for(var k in s)a[k]=s[k];a.data=b;a.width=c;a.height=e;k={};if(n&&typeof n===r)for(var q in n)k[q]=n[q];if(i&&
typeof i===r)for(var u in i)k.flashvars=typeof k.flashvars!=p?k.flashvars+("&"+u+"="+i[u]):u+"="+i[u];if(t(f))q=l(a,k,d),a.id==d&&w(d,!0),m.success=!0,m.ref=q;else{if(j&&h()){a.data=j;g(a,k,d,o);return}w(d,!0)}o&&o(m)})):o&&o(m)},switchOffAutoHideShow:function(){N=!1},ua:k,getFlashPlayerVersion:function(){return{major:k.pv[0],minor:k.pv[1],release:k.pv[2]}},hasFlashPlayerVersion:t,createSWF:function(a,b,d){if(k.w3)return l(a,b,d)},showExpressInstall:function(a,b,d,c){k.w3&&h()&&g(a,b,d,c)},removeSWF:function(a){k.w3&&
j(a)},createCSS:function(a,b,d,c){k.w3&&A(a,b,d,c)},addDomLoadEvent:a,addLoadEvent:b,getQueryParamValue:function(a){var b=m.location.search||m.location.hash;if(b){/\?/.test(b)&&(b=b.split("?")[1]);if(null==a)return J(b);for(var b=b.split("&"),d=0;d<b.length;d++)if(b[d].substring(0,b[d].indexOf("="))==a)return J(b[d].substring(b[d].indexOf("=")+1))}return""},expressInstallCallback:function(){if(E){var a=s(M);a&&C&&(a.parentNode.replaceChild(C,a),F&&(w(F,!0),k.ie&&k.win&&(C.style.display="block")),
H&&H(K));E=!1}}}}();
(function(){if(!("undefined"==typeof window||window.WebSocket)){var c=window.console;if(!c||!c.log||!c.error)c={log:function(){},error:function(){}};swfobject.hasFlashPlayerVersion("10.0.0")?("file:"==location.protocol&&c.error("WARNING: web-socket-js doesn't work in file:///... URL unless you set Flash Security Settings properly. Open the page via Web server i.e. http://..."),WebSocket=function(a,b,d,c,f){var h=this;h.__id=WebSocket.__nextId++;WebSocket.__instances[h.__id]=h;h.readyState=WebSocket.CONNECTING;
h.bufferedAmount=0;h.__events={};b?"string"==typeof b&&(b=[b]):b=[];setTimeout(function(){WebSocket.__addTask(function(){WebSocket.__flash.create(h.__id,a,b,d||null,c||0,f||null)})},0)},WebSocket.prototype.send=function(a){if(this.readyState==WebSocket.CONNECTING)throw"INVALID_STATE_ERR: Web Socket connection has not been established";a=WebSocket.__flash.send(this.__id,encodeURIComponent(a));if(0>a)return!0;this.bufferedAmount+=a;return!1},WebSocket.prototype.close=function(){this.readyState==WebSocket.CLOSED||
this.readyState==WebSocket.CLOSING||(this.readyState=WebSocket.CLOSING,WebSocket.__flash.close(this.__id))},WebSocket.prototype.addEventListener=function(a,b){a in this.__events||(this.__events[a]=[]);this.__events[a].push(b)},WebSocket.prototype.removeEventListener=function(a,b){if(a in this.__events)for(var d=this.__events[a],c=d.length-1;0<=c;--c)if(d[c]===b){d.splice(c,1);break}},WebSocket.prototype.dispatchEvent=function(a){for(var b=this.__events[a.type]||[],d=0;d<b.length;++d)b[d](a);(b=this["on"+
a.type])&&b(a)},WebSocket.prototype.__handleEvent=function(a){"readyState"in a&&(this.readyState=a.readyState);"protocol"in a&&(this.protocol=a.protocol);if("open"==a.type||"error"==a.type)a=this.__createSimpleEvent(a.type);else if("close"==a.type)a=this.__createSimpleEvent("close");else if("message"==a.type)a=this.__createMessageEvent("message",decodeURIComponent(a.message));else throw"unknown event type: "+a.type;this.dispatchEvent(a)},WebSocket.prototype.__createSimpleEvent=function(a){if(document.createEvent&&
window.Event){var b=document.createEvent("Event");b.initEvent(a,!1,!1);return b}return{type:a,bubbles:!1,cancelable:!1}},WebSocket.prototype.__createMessageEvent=function(a,b){if(document.createEvent&&window.MessageEvent&&!window.opera){var d=document.createEvent("MessageEvent");d.initMessageEvent("message",!1,!1,b,null,null,window,null);return d}return{type:a,data:b,bubbles:!1,cancelable:!1}},WebSocket.CONNECTING=0,WebSocket.OPEN=1,WebSocket.CLOSING=2,WebSocket.CLOSED=3,WebSocket.__flash=null,WebSocket.__instances=
{},WebSocket.__tasks=[],WebSocket.__nextId=0,WebSocket.loadFlashPolicyFile=function(a){WebSocket.__addTask(function(){WebSocket.__flash.loadManualPolicyFile(a)})},WebSocket.__initialize=function(){if(!WebSocket.__flash)if(WebSocket.__swfLocation&&(window.WEB_SOCKET_SWF_LOCATION=WebSocket.__swfLocation),window.WEB_SOCKET_SWF_LOCATION){var a=document.createElement("div");a.id="webSocketContainer";a.style.position="absolute";WebSocket.__isFlashLite()?(a.style.left="0px",a.style.top="0px"):(a.style.left=
"-100px",a.style.top="-100px");var b=document.createElement("div");b.id="webSocketFlash";a.appendChild(b);document.body.appendChild(a);swfobject.embedSWF(WEB_SOCKET_SWF_LOCATION,"webSocketFlash","1","1","10.0.0",null,null,{hasPriority:!0,swliveconnect:!0,allowScriptAccess:"always"},null,function(a){a.success||c.error("[WebSocket] swfobject.embedSWF failed")})}else c.error("[WebSocket] set WEB_SOCKET_SWF_LOCATION to location of WebSocketMain.swf")},WebSocket.__onFlashInitialized=function(){setTimeout(function(){WebSocket.__flash=
document.getElementById("webSocketFlash");WebSocket.__flash.setCallerUrl(location.href);WebSocket.__flash.setDebug(!!window.WEB_SOCKET_DEBUG);for(var a=0;a<WebSocket.__tasks.length;++a)WebSocket.__tasks[a]();WebSocket.__tasks=[]},0)},WebSocket.__onFlashEvent=function(){setTimeout(function(){try{for(var a=WebSocket.__flash.receiveEvents(),b=0;b<a.length;++b)WebSocket.__instances[a[b].webSocketId].__handleEvent(a[b])}catch(d){c.error(d)}},0);return!0},WebSocket.__log=function(a){c.log(decodeURIComponent(a))},
WebSocket.__error=function(a){c.error(decodeURIComponent(a))},WebSocket.__addTask=function(a){WebSocket.__flash?a():WebSocket.__tasks.push(a)},WebSocket.__isFlashLite=function(){if(!window.navigator||!window.navigator.mimeTypes)return!1;var a=window.navigator.mimeTypes["application/x-shockwave-flash"];return!a||!a.enabledPlugin||!a.enabledPlugin.filename?!1:a.enabledPlugin.filename.match(/flashlite/i)?!0:!1},window.WEB_SOCKET_DISABLE_AUTO_INITIALIZATION||(window.addEventListener?window.addEventListener("load",
function(){WebSocket.__initialize()},!1):window.attachEvent("onload",function(){WebSocket.__initialize()}))):c.error("Flash Player >= 10.0.0 is required.")}})();
(function(c,a,b){function d(b){b&&(a.Transport.apply(this,arguments),this.sendBuffer=[])}function e(){}c.XHR=d;a.util.inherit(d,a.Transport);d.prototype.open=function(){this.socket.setBuffer(!1);this.onOpen();this.get();this.setCloseTimeout();return this};d.prototype.payload=function(b){for(var d=[],c=0,e=b.length;c<e;c++)d.push(a.parser.encodePacket(b[c]));this.send(a.parser.encodePayload(d))};d.prototype.send=function(a){this.post(a);return this};d.prototype.post=function(a){function d(){if(4==
this.readyState)if(this.onreadystatechange=e,i.posting=!1,200==this.status)i.socket.setBuffer(!1);else i.onClose()}function c(){this.onload=e;i.socket.setBuffer(!1)}var i=this;this.socket.setBuffer(!0);this.sendXHR=this.request("POST");b.XDomainRequest&&this.sendXHR instanceof XDomainRequest?this.sendXHR.onload=this.sendXHR.onerror=c:this.sendXHR.onreadystatechange=d;this.sendXHR.send(a)};d.prototype.close=function(){this.onClose();return this};d.prototype.request=function(b){var d=a.util.request(this.socket.isXDomain()),
c=a.util.query(this.socket.options.query,"t="+ +new Date);d.open(b||"GET",this.prepareUrl()+c,!0);if("POST"==b)try{d.setRequestHeader?d.setRequestHeader("Content-type","text/plain;charset=UTF-8"):d.contentType="text/plain"}catch(e){}return d};d.prototype.scheme=function(){return this.socket.options.secure?"https":"http"};d.check=function(d,c){try{var g=a.util.request(c),e=b.XDomainRequest&&g instanceof XDomainRequest,n=(d&&d.options&&d.options.secure?"https:":"http:")!=b.location.protocol;if(g&&(!e||
!n))return!0}catch(l){}return!1};d.xdomainCheck=function(){return d.check(null,!0)}})("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this);
(function(c,a){function b(b){a.Transport.XHR.apply(this,arguments)}c.htmlfile=b;a.util.inherit(b,a.Transport.XHR);b.prototype.name="htmlfile";b.prototype.get=function(){this.doc=new (window[["Active"].concat("Object").join("X")])("htmlfile");this.doc.open();this.doc.write("<html></html>");this.doc.close();this.doc.parentWindow.s=this;var b=this.doc.createElement("div");b.className="socketio";this.doc.body.appendChild(b);this.iframe=this.doc.createElement("iframe");b.appendChild(this.iframe);var c=
this,b=a.util.query(this.socket.options.query,"t="+ +new Date);this.iframe.src=this.prepareUrl()+b;a.util.on(window,"unload",function(){c.destroy()})};b.prototype._=function(a,b){this.onData(a);try{var c=b.getElementsByTagName("script")[0];c.parentNode.removeChild(c)}catch(h){}};b.prototype.destroy=function(){if(this.iframe){try{this.iframe.src="about:blank"}catch(a){}this.doc=null;this.iframe.parentNode.removeChild(this.iframe);this.iframe=null;CollectGarbage()}};b.prototype.close=function(){this.destroy();
return a.Transport.XHR.prototype.close.call(this)};b.check=function(){if("undefined"!=typeof window&&["Active"].concat("Object").join("X")in window)try{return new (window[["Active"].concat("Object").join("X")])("htmlfile")&&a.Transport.XHR.check()}catch(b){}return!1};b.xdomainCheck=function(){return!1};a.transports.push("htmlfile")})("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports);
(function(c,a,b){function d(){a.Transport.XHR.apply(this,arguments)}function e(){}c["xhr-polling"]=d;a.util.inherit(d,a.Transport.XHR);a.util.merge(d,a.Transport.XHR);d.prototype.name="xhr-polling";d.prototype.open=function(){a.Transport.XHR.prototype.open.call(this);return!1};d.prototype.get=function(){function a(){if(4==this.readyState)if(this.onreadystatechange=e,200==this.status)i.onData(this.responseText),i.get();else i.onClose()}function d(){this.onerror=this.onload=e;i.onData(this.responseText);
i.get()}function c(){i.onClose()}if(this.open){var i=this;this.xhr=this.request();b.XDomainRequest&&this.xhr instanceof XDomainRequest?(this.xhr.onload=d,this.xhr.onerror=c):this.xhr.onreadystatechange=a;this.xhr.send(null)}};d.prototype.onClose=function(){a.Transport.XHR.prototype.onClose.call(this);if(this.xhr){this.xhr.onreadystatechange=this.xhr.onload=this.xhr.onerror=e;try{this.xhr.abort()}catch(b){}this.xhr=null}};d.prototype.ready=function(b,d){var c=this;a.util.defer(function(){d.call(c)})};
a.transports.push("xhr-polling")})("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this);
(function(c,a,b){function d(b){a.Transport["xhr-polling"].apply(this,arguments);this.index=a.j.length;var d=this;a.j.push(function(a){d._(a)})}var e=b.document&&"MozAppearance"in b.document.documentElement.style;c["jsonp-polling"]=d;a.util.inherit(d,a.Transport["xhr-polling"]);d.prototype.name="jsonp-polling";d.prototype.post=function(b){function d(){c();e.socket.setBuffer(!1)}function c(){e.iframe&&e.form.removeChild(e.iframe);try{o=document.createElement('<iframe name="'+e.iframeId+'">')}catch(a){o=
document.createElement("iframe"),o.name=e.iframeId}o.id=e.iframeId;e.form.appendChild(o);e.iframe=o}var e=this,n=a.util.query(this.socket.options.query,"t="+ +new Date+"&i="+this.index);if(!this.form){var l=document.createElement("form"),j=document.createElement("textarea"),s=this.iframeId="socketio_iframe_"+this.index,o;l.className="socketio";l.style.position="absolute";l.style.top="0px";l.style.left="0px";l.style.display="none";l.target=s;l.method="POST";l.setAttribute("accept-charset","utf-8");
j.name="d";l.appendChild(j);document.body.appendChild(l);this.form=l;this.area=j}this.form.action=this.prepareUrl()+n;c();this.area.value=a.JSON.stringify(b);try{this.form.submit()}catch(t){}this.iframe.attachEvent?o.onreadystatechange=function(){"complete"==e.iframe.readyState&&d()}:this.iframe.onload=d;this.socket.setBuffer(!0)};d.prototype.get=function(){var b=this,d=document.createElement("script"),c=a.util.query(this.socket.options.query,"t="+ +new Date+"&i="+this.index);this.script&&(this.script.parentNode.removeChild(this.script),
this.script=null);d.async=!0;d.src=this.prepareUrl()+c;d.onerror=function(){b.onClose()};c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(d,c);this.script=d;e&&setTimeout(function(){var a=document.createElement("iframe");document.body.appendChild(a);document.body.removeChild(a)},100)};d.prototype._=function(a){this.onData(a);this.open&&this.get();return this};d.prototype.ready=function(b,d){var c=this;if(!e)return d.call(this);a.util.load(function(){d.call(c)})};d.check=function(){return"document"in
b};d.xdomainCheck=function(){return!0};a.transports.push("jsonp-polling")})("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this);var Erizo=Erizo||{};
Erizo.EventDispatcher=function(c){var a={};c.dispatcher={};c.dispatcher.eventListeners={};a.addEventListener=function(a,d){void 0===c.dispatcher.eventListeners[a]&&(c.dispatcher.eventListeners[a]=[]);c.dispatcher.eventListeners[a].push(d)};a.removeEventListener=function(a,d){var e;e=c.dispatcher.eventListeners[a].indexOf(d);-1!==e&&c.dispatcher.eventListeners[a].splice(e,1)};a.dispatchEvent=function(a){var d;L.Logger.debug("Event: "+a.type);for(d in c.dispatcher.eventListeners[a.type])if(c.dispatcher.eventListeners[a.type].hasOwnProperty(d))c.dispatcher.eventListeners[a.type][d](a)};return a};
Erizo.LicodeEvent=function(c){var a={};a.type=c.type;return a};Erizo.RoomEvent=function(c){var a=Erizo.LicodeEvent(c);a.streams=c.streams;return a};Erizo.StreamEvent=function(c){var a=Erizo.LicodeEvent(c);a.stream=c.stream;a.msg=c.msg;return a};Erizo.PublisherEvent=function(c){return Erizo.LicodeEvent(c)};Erizo=Erizo||{};Erizo.FcStack=function(){return{addStream:function(){}}};Erizo=Erizo||{};
Erizo.FirefoxStack=function(c){var a={},b=mozRTCPeerConnection,d=mozRTCSessionDescription,e=!1;a.pc_config={iceServers:[]};void 0!==c.stunServerUrl&&a.pc_config.iceServers.push({url:c.stunServerUrl});if((c.turnServer||{}).url)console.log("using turn server "+c.turnServer.url),a.pc_config.iceServers.push({username:c.turnServer.username,credential:c.turnServer.password,url:c.turnServer.url});void 0===c.audio&&(c.audio=!0);void 0===c.video&&(c.video=!0);a.mediaConstraints={optional:[],mandatory:{OfferToReceiveAudio:c.audio,
OfferToReceiveVideo:c.video,MozDontOfferDataChannel:!0}};a.roapSessionId=103;a.peerConnection=new b;a.peerConnection.onicecandidate=function(b){L.Logger.debug("PeerConnection: ",c.session_id);if(b.candidate)a.iceCandidateCount=a.iceCandidateCount+1;else{L.Logger.debug("State: "+a.peerConnection.iceGatheringState);if(a.ices===void 0)a.ices=0;a.ices=a.ices+1;L.Logger.debug(a.ices);if(a.ices>=1&&a.moreIceComing){a.moreIceComing=false;a.markActionNeeded()}}};L.Logger.debug('Created webkitRTCPeerConnnection with config "'+
JSON.stringify(a.pc_config)+'".');a.processSignalingMessage=function(b){L.Logger.debug("Activity on conn "+a.sessionId);b=JSON.parse(b);a.incomingMessage=b;if(a.state==="new")if(b.messageType==="OFFER"){b={sdp:b.sdp,type:"offer"};a.peerConnection.setRemoteDescription(new d(b));a.state="offer-received";a.markActionNeeded()}else a.error("Illegal message for this state: "+b.messageType+" in state "+a.state);else if(a.state==="offer-sent")if(b.messageType==="ANSWER"){b.sdp=b.sdp.replace(/ generation 0/g,
"");b.sdp=b.sdp.replace(/ udp /g," UDP ");b={sdp:b.sdp,type:"answer"};L.Logger.debug("Received ANSWER: ",b.sdp);a.peerConnection.setRemoteDescription(new d(b));a.sendOK();a.state="established"}else if(b.messageType==="pr-answer"){b={sdp:b.sdp,type:"pr-answer"};a.peerConnection.setRemoteDescription(new d(b))}else b.messageType==="offer"?a.error("Not written yet"):a.error("Illegal message for this state: "+b.messageType+" in state "+a.state);else if(a.state==="established")if(b.messageType==="OFFER"){b=
{sdp:b.sdp,type:"offer"};a.peerConnection.setRemoteDescription(new d(b));a.state="offer-received";a.markActionNeeded()}else a.error("Illegal message for this state: "+b.messageType+" in state "+a.state)};a.addStream=function(b){e=true;a.peerConnection.addStream(b);a.markActionNeeded()};a.removeStream=function(){a.markActionNeeded()};a.close=function(){a.state="closed";a.peerConnection.close()};a.markActionNeeded=function(){a.actionNeeded=true;a.doLater(function(){a.onstablestate()})};a.doLater=function(a){window.setTimeout(a,
1)};a.onstablestate=function(){var b;if(a.actionNeeded){if(a.state==="new"||a.state==="established"){L.Logger.debug("Creating offer");if(e)a.mediaConstraints=void 0;(function(){a.peerConnection.createOffer(function(b){var d=b.sdp;L.Logger.debug("Changed",b.sdp);if(d!==a.prevOffer){a.peerConnection.setLocalDescription(b);a.state="preparing-offer";a.markActionNeeded()}else L.Logger.debug("Not sending a new offer")},function(a){L.Logger.debug("Ups! Something went wrong ",a)},a.mediaConstraints)})()}else if(a.state===
"preparing-offer"){if(a.moreIceComing)return;a.prevOffer=a.peerConnection.localDescription.sdp;L.Logger.debug("Sending OFFER: ",a.prevOffer);a.sendMessage("OFFER",a.prevOffer);a.state="offer-sent"}else if(a.state==="offer-received")a.peerConnection.createAnswer(function(b){a.peerConnection.setLocalDescription(b);a.state="offer-received-preparing-answer";if(a.iceStarted)a.markActionNeeded();else{L.Logger.debug((new Date).getTime()+": Starting ICE in responder");a.iceStarted=true}},function(){L.Logger.debug("Ups! Something went wrong")});
else if(a.state==="offer-received-preparing-answer"){if(a.moreIceComing)return;b=a.peerConnection.localDescription.sdp;a.sendMessage("ANSWER",b);a.state="established"}else a.error("Dazed and confused in state "+a.state+", stopping here");a.actionNeeded=false}};a.sendOK=function(){a.sendMessage("OK")};a.sendMessage=function(b,d){var c={};c.messageType=b;c.sdp=d;if(b==="OFFER"){c.offererSessionId=a.sessionId;c.answererSessionId=a.otherSessionId;c.seq=a.sequenceNumber=a.sequenceNumber+1;c.tiebreaker=
Math.floor(Math.random()*429496723+1)}else{c.offererSessionId=a.incomingMessage.offererSessionId;c.answererSessionId=a.sessionId;c.seq=a.incomingMessage.seq}a.onsignalingmessage(JSON.stringify(c))};a.error=function(a){throw"Error in RoapOnJsep: "+a;};a.sessionId=a.roapSessionId+=1;a.sequenceNumber=0;a.actionNeeded=!1;a.iceStarted=!1;a.moreIceComing=!0;a.iceCandidateCount=0;a.onsignalingmessage=c.callback;a.peerConnection.onopen=function(){if(a.onopen)a.onopen()};a.peerConnection.onaddstream=function(b){if(a.onaddstream)a.onaddstream(b)};
a.peerConnection.onremovestream=function(b){if(a.onremovestream)a.onremovestream(b)};a.peerConnection.oniceconnectionstatechange=function(b){if(a.oniceconnectionstatechange)a.oniceconnectionstatechange(b.currentTarget.iceConnectionState)};a.onaddstream=null;a.onremovestream=null;a.state="new";a.markActionNeeded();return a};Erizo=Erizo||{};
Erizo.ChromeStableStack=function(c){var a={},b=webkitRTCPeerConnection;a.pc_config={iceServers:[]};a.con={optional:[{DtlsSrtpKeyAgreement:!0}]};void 0!==c.stunServerUrl&&a.pc_config.iceServers.push({url:c.stunServerUrl});if((c.turnServer||{}).url)console.log("using turn server "+c.turnServer.url),a.pc_config.iceServers.push({username:c.turnServer.username,credential:c.turnServer.password,url:c.turnServer.url});if(void 0===c.audio||c.nop2p)c.audio=!0;if(void 0===c.video||c.nop2p)c.video=!0;a.mediaConstraints=
{mandatory:{OfferToReceiveVideo:c.video,OfferToReceiveAudio:c.audio}};a.roapSessionId=103;a.peerConnection=new b(a.pc_config,a.con);a.peerConnection.onicecandidate=function(b){L.Logger.debug("PeerConnection: ",c.session_id);if(b.candidate)a.iceCandidateCount+=1;else if(L.Logger.debug("State: "+a.peerConnection.iceGatheringState),void 0===a.ices&&(a.ices=0),a.ices+=1,1<=a.ices&&a.moreIceComing)a.moreIceComing=!1,a.markActionNeeded()};a.processSignalingMessage=function(b){L.Logger.debug("Activity on conn "+
a.sessionId);b=JSON.parse(b);a.incomingMessage=b;"new"===a.state?"OFFER"===b.messageType?(b={sdp:b.sdp,type:"offer"},a.peerConnection.setRemoteDescription(new RTCSessionDescription(b)),a.state="offer-received",a.markActionNeeded()):a.error("Illegal message for this state: "+b.messageType+" in state "+a.state):"offer-sent"===a.state?"ANSWER"===b.messageType?(b={sdp:b.sdp,type:"answer"},b.sdp=setBandwidth(b.sdp),L.Logger.debug("Received ANSWER: ",b.sdp),a.peerConnection.setRemoteDescription(new RTCSessionDescription(b)),
a.sendOK(),a.state="established"):"pr-answer"===b.messageType?(b={sdp:b.sdp,type:"pr-answer"},a.peerConnection.setRemoteDescription(new RTCSessionDescription(b))):"offer"===b.messageType?a.error("Not written yet"):a.error("Illegal message for this state: "+b.messageType+" in state "+a.state):"established"===a.state&&("OFFER"===b.messageType?(b={sdp:b.sdp,type:"offer"},a.peerConnection.setRemoteDescription(new RTCSessionDescription(b)),a.state="offer-received",a.markActionNeeded()):a.error("Illegal message for this state: "+
b.messageType+" in state "+a.state))};a.addStream=function(b){a.peerConnection.addStream(b);a.markActionNeeded()};a.removeStream=function(){a.markActionNeeded()};a.close=function(){a.state="closed";a.peerConnection.close()};a.markActionNeeded=function(){a.actionNeeded=!0;a.doLater(function(){a.onstablestate()})};a.doLater=function(a){window.setTimeout(a,1)};a.onstablestate=function(){var b;if(a.actionNeeded){if("new"===a.state||"established"===a.state)a.peerConnection.createOffer(function(b){b.sdp=
setBandwidth(b.sdp);L.Logger.debug("Changed",b.sdp);b.sdp!==a.prevOffer?(a.peerConnection.setLocalDescription(b),a.state="preparing-offer",a.markActionNeeded()):L.Logger.debug("Not sending a new offer")},null,a.mediaConstraints);else if("preparing-offer"===a.state){if(a.moreIceComing)return;a.prevOffer=a.peerConnection.localDescription.sdp;L.Logger.debug("Sending OFFER: "+a.prevOffer);a.sendMessage("OFFER",a.prevOffer);a.state="offer-sent"}else if("offer-received"===a.state)a.peerConnection.createAnswer(function(b){a.peerConnection.setLocalDescription(b);
a.state="offer-received-preparing-answer";a.iceStarted?a.markActionNeeded():(L.Logger.debug((new Date).getTime()+": Starting ICE in responder"),a.iceStarted=!0)},null,a.mediaConstraints);else if("offer-received-preparing-answer"===a.state){if(a.moreIceComing)return;b=a.peerConnection.localDescription.sdp;a.sendMessage("ANSWER",b);a.state="established"}else a.error("Dazed and confused in state "+a.state+", stopping here");a.actionNeeded=!1}};a.sendOK=function(){a.sendMessage("OK")};a.sendMessage=function(b,
c){var f={};f.messageType=b;f.sdp=c;"OFFER"===b?(f.offererSessionId=a.sessionId,f.answererSessionId=a.otherSessionId,f.seq=a.sequenceNumber+=1,f.tiebreaker=Math.floor(429496723*Math.random()+1)):(f.offererSessionId=a.incomingMessage.offererSessionId,f.answererSessionId=a.sessionId,f.seq=a.incomingMessage.seq);a.onsignalingmessage(JSON.stringify(f))};a.error=function(a){throw"Error in RoapOnJsep: "+a;};a.sessionId=a.roapSessionId+=1;a.sequenceNumber=0;a.actionNeeded=!1;a.iceStarted=!1;a.moreIceComing=
!0;a.iceCandidateCount=0;a.onsignalingmessage=c.callback;a.peerConnection.onopen=function(){if(a.onopen)a.onopen()};a.peerConnection.onaddstream=function(b){if(a.onaddstream)a.onaddstream(b)};a.peerConnection.onremovestream=function(b){if(a.onremovestream)a.onremovestream(b)};a.peerConnection.oniceconnectionstatechange=function(b){if(a.oniceconnectionstatechange)a.oniceconnectionstatechange(b.currentTarget.iceConnectionState)};a.onaddstream=null;a.onremovestream=null;a.state="new";a.markActionNeeded();
return a};Erizo=Erizo||{};
Erizo.ChromeCanaryStack=function(c){var a={},b=webkitRTCPeerConnection;a.pc_config={iceServers:[]};a.con={optional:[{DtlsSrtpKeyAgreement:!0}]};void 0!==c.stunServerUrl&&a.pc_config.iceServers.push({url:c.stunServerUrl});if((c.turnServer||{}).url)console.log("using turn server "+c.turnServer.url),a.pc_config.iceServers.push({username:c.turnServer.username,credential:c.turnServer.password,url:c.turnServer.url});if(void 0===c.audio||c.nop2p)c.audio=!0;if(void 0===c.video||c.nop2p)c.video=!0;a.mediaConstraints=
{mandatory:{OfferToReceiveVideo:c.video,OfferToReceiveAudio:c.audio}};a.roapSessionId=103;a.peerConnection=new b(a.pc_config,a.con);a.peerConnection.onicecandidate=function(b){L.Logger.debug("PeerConnection: ",c.session_id);if(b.candidate)a.iceCandidateCount+=1;else if(L.Logger.debug("State: "+a.peerConnection.iceGatheringState),void 0===a.ices&&(a.ices=0),a.ices+=1,1<=a.ices&&a.moreIceComing)a.moreIceComing=!1,a.markActionNeeded()};a.processSignalingMessage=function(b){L.Logger.debug("Activity on conn "+
a.sessionId);b=JSON.parse(b);a.incomingMessage=b;"new"===a.state?"OFFER"===b.messageType?(b={sdp:b.sdp,type:"offer"},a.peerConnection.setRemoteDescription(new RTCSessionDescription(b)),a.state="offer-received",a.markActionNeeded()):a.error("Illegal message for this state: "+b.messageType+" in state "+a.state):"offer-sent"===a.state?"ANSWER"===b.messageType?(b={sdp:b.sdp,type:"answer"},b.sdp=setBandwidth(b.sdp),L.Logger.debug("Received ANSWER: ",b.sdp),a.peerConnection.setRemoteDescription(new RTCSessionDescription(b)),
a.sendOK(),a.state="established"):"pr-answer"===b.messageType?(b={sdp:b.sdp,type:"pr-answer"},a.peerConnection.setRemoteDescription(new RTCSessionDescription(b))):"offer"===b.messageType?a.error("Not written yet"):a.error("Illegal message for this state: "+b.messageType+" in state "+a.state):"established"===a.state&&("OFFER"===b.messageType?(b={sdp:b.sdp,type:"offer"},a.peerConnection.setRemoteDescription(new RTCSessionDescription(b)),a.state="offer-received",a.markActionNeeded()):a.error("Illegal message for this state: "+
b.messageType+" in state "+a.state))};a.addStream=function(b){a.peerConnection.addStream(b);a.markActionNeeded()};a.removeStream=function(){a.markActionNeeded()};a.close=function(){a.state="closed";a.peerConnection.close()};a.markActionNeeded=function(){a.actionNeeded=!0;a.doLater(function(){a.onstablestate()})};a.doLater=function(a){window.setTimeout(a,1)};a.onstablestate=function(){var b;if(a.actionNeeded){if("new"===a.state||"established"===a.state)a.peerConnection.createOffer(function(b){b.sdp=
setBandwidth(b.sdp);L.Logger.debug("Changed",b.sdp);var c=b.sdp,c=b.sdp;c!==a.prevOffer?(a.peerConnection.setLocalDescription(b),a.state="preparing-offer",a.markActionNeeded()):L.Logger.debug("Not sending a new offer")},null,a.mediaConstraints);else if("preparing-offer"===a.state){if(a.moreIceComing)return;a.prevOffer=a.peerConnection.localDescription.sdp;L.Logger.debug("Sending OFFER: "+a.prevOffer);a.sendMessage("OFFER",a.prevOffer);a.state="offer-sent"}else if("offer-received"===a.state)a.peerConnection.createAnswer(function(b){a.peerConnection.setLocalDescription(b);
a.state="offer-received-preparing-answer";a.iceStarted?a.markActionNeeded():(L.Logger.debug((new Date).getTime()+": Starting ICE in responder"),a.iceStarted=!0)},null,a.mediaConstraints);else if("offer-received-preparing-answer"===a.state){if(a.moreIceComing)return;b=a.peerConnection.localDescription.sdp;a.sendMessage("ANSWER",b);a.state="established"}else a.error("Dazed and confused in state "+a.state+", stopping here");a.actionNeeded=!1}};a.sendOK=function(){a.sendMessage("OK")};a.sendMessage=function(b,
c){var f={};f.messageType=b;f.sdp=c;"OFFER"===b?(f.offererSessionId=a.sessionId,f.answererSessionId=a.otherSessionId,f.seq=a.sequenceNumber+=1,f.tiebreaker=Math.floor(429496723*Math.random()+1)):(f.offererSessionId=a.incomingMessage.offererSessionId,f.answererSessionId=a.sessionId,f.seq=a.incomingMessage.seq);a.onsignalingmessage(JSON.stringify(f))};a.error=function(a){throw"Error in RoapOnJsep: "+a;};a.sessionId=a.roapSessionId+=1;a.sequenceNumber=0;a.actionNeeded=!1;a.iceStarted=!1;a.moreIceComing=
!0;a.iceCandidateCount=0;a.onsignalingmessage=c.callback;a.peerConnection.onopen=function(){if(a.onopen)a.onopen()};a.peerConnection.onaddstream=function(b){if(a.onaddstream)a.onaddstream(b)};a.peerConnection.onremovestream=function(b){if(a.onremovestream)a.onremovestream(b)};a.peerConnection.oniceconnectionstatechange=function(b){if(a.oniceconnectionstatechange)a.oniceconnectionstatechange(b.currentTarget.iceConnectionState)};a.onaddstream=null;a.onremovestream=null;a.state="new";a.markActionNeeded();
return a};Erizo=Erizo||{};Erizo.sessionId=103;
Erizo.Connection=function(c){var a={};c.session_id=Erizo.sessionId+=1;a.browser="";if("undefined"!==typeof module&&module.exports)console.log("FcStack"),L.Logger.error("Publish/subscribe video/audio streams not supported in erizofc yet"),a=Erizo.FcStack(c);else if("Chrome"==BrowserDetect.browser&&25<=parseInt(BrowserDetect.version)&&33>=parseInt(BrowserDetect.version))console.log("Stable! "+parseInt(BrowserDetect.version)),a=Erizo.ChromeStableStack(c),a.browser="chrome-stable";else if("Chrome"==BrowserDetect.browser&&
33<parseInt(BrowserDetect.version))console.log("Canary! "+parseInt(BrowserDetect.version)),a=Erizo.ChromeCanaryStack(c),a.browser="chrome-canary";else if("Bowser"==BrowserDetect.browser&&("25"==parseInt(BrowserDetect.version)||"28"==parseInt(BrowserDetect.version)))a.browser="bowser";else if("Firefox"==BrowserDetect.browser&&20<=parseInt(BrowserDetect.version))console.log("Firefox!"),a=Erizo.FirefoxStack(c),a.browser="mozilla";else throw a.browser="none","WebRTC stack not available";return a};
Erizo.GetUserMedia=function(c,a,b){navigator.getMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;"undefined"!==typeof module&&module.exports?L.Logger.error("Video/audio streams not supported in erizofc yet"):navigator.getMedia(c,a,b)};Erizo=Erizo||{};
Erizo.Stream=function(c){var a=Erizo.EventDispatcher(c),b;a.stream=c.stream;a.url=c.url;a.room=void 0;a.showing=!1;a.local=!1;a.video=c.video;a.audio=c.audio;a.screen=c.screen;a.videoSize=c.videoSize;if(void 0!==a.videoSize&&(!(a.videoSize instanceof Array)||4!=a.videoSize.length))throw Error("Invalid Video Size");if(void 0===c.local||!0===c.local)a.local=!0;a.getID=function(){return c.streamID};a.getAttributes=function(){return c.attributes};a.hasAudio=function(){return c.audio};a.hasVideo=function(){return c.video};
a.hasData=function(){return c.data};a.hasScreen=function(){return c.screen};a.sendData=function(){L.Logger.error("Failed to send data. This Stream object has not that channel enabled.")};a.init=function(){try{if((c.audio||c.video||c.screen)&&void 0===c.url){L.Logger.debug("Requested access to local media");var b=c.video;!0==b&&void 0!==a.videoSize&&(b={mandatory:{minWidth:a.videoSize[0],minHeight:a.videoSize[1],maxWidth:a.videoSize[2],maxHeight:a.videoSize[3]}});var e={video:b,audio:c.audio,fake:c.fake};
c.screen&&(e={video:{mandatory:{chromeMediaSource:"screen",maxWidth:screen.availWidth,maxHeight:screen.availHeight}}});L.Logger.debug(e);Erizo.GetUserMedia(e,function(b){L.Logger.info("User has granted access to local media.");a.stream=b;b=Erizo.StreamEvent({type:"access-accepted"});a.dispatchEvent(b)},function(b){L.Logger.error("Failed to get access to local media. Error code was "+b.code+".");b=Erizo.StreamEvent({type:"access-denied"});a.dispatchEvent(b)})}else{var f=Erizo.StreamEvent({type:"access-accepted"});
a.dispatchEvent(f)}}catch(h){L.Logger.error("Error accessing to local media",h)}};a.close=function(){a.local&&(void 0!==a.room&&a.room.unpublish(a),a.hide(),void 0!==a.stream&&a.stream.stop(),a.stream=void 0)};a.play=function(b,c,f){a.elementID=b;a.hasVideo()||this.hasScreen()?void 0!==b&&(b=new Erizo.VideoPlayer({id:a.getID(),stream:a,elementID:b,options:c}),a.player=b,a.showing=!0,f&&f()):a.hasAudio&&(b=new Erizo.AudioPlayer({id:a.getID(),stream:a,elementID:b,options:c}),a.player=b,a.showing=!0)};
a.stop=function(){a.showing&&void 0!==a.player&&(a.player.destroy(),a.showing=!1)};a.show=a.play;a.hide=a.stop;b=function(){if(void 0!==a.player&&void 0!==a.stream){var b=a.player.video,c=document.defaultView.getComputedStyle(b),f=parseInt(c.getPropertyValue("width"),10),h=parseInt(c.getPropertyValue("height"),10),g=parseInt(c.getPropertyValue("left"),10),c=parseInt(c.getPropertyValue("top"),10),i=document.getElementById(a.elementID),n=document.defaultView.getComputedStyle(i),i=parseInt(n.getPropertyValue("width"),
10),n=parseInt(n.getPropertyValue("height"),10),l=document.createElement("canvas");l.id="testing";l.width=i;l.height=n;l.setAttribute("style","display: none");l.getContext("2d").drawImage(b,g,c,f,h);return l}return null};a.showOverlay=function(){void 0!==a.player&&a.player.showOverlay()};a.hideOverlay=function(){void 0!==a.player&&a.player.hideOverlay()};a.getVideoFrameURL=function(a){var c=b();return null!==c?a?c.toDataURL(a):c.toDataURL():null};a.getVideoFrame=function(){var a=b();return null!==
a?a.getContext("2d").getImageData(0,0,a.width,a.height):null};return a};Erizo=Erizo||{};
Erizo.Room=function(c){var a=Erizo.EventDispatcher(c),b,d,e,f,h;a.remoteStreams={};a.localStreams={};a.roomID="";a.socket={};a.state=0;a.p2p=!1;a.addEventListener("room-disconnected",function(){var b,c;a.state=0;for(b in a.remoteStreams)a.remoteStreams.hasOwnProperty(b)&&(c=a.remoteStreams[b],h(c),delete a.remoteStreams[b],c=Erizo.StreamEvent({type:"stream-removed",stream:c}),a.dispatchEvent(c));a.remoteStreams={};for(b in a.localStreams)a.localStreams.hasOwnProperty(b)&&(c=a.localStreams[b],c.pc.close(),
delete a.localStreams[b]);try{a.socket.disconnect()}catch(d){L.Logger.debug("Socket already disconnected")}L.Logger.debug("Closing Socket");a.socket=void 0});h=function(a){void 0!==a.stream&&(a.hide(),a.pc.close(),a.local&&a.stream.stop())};f=function(a,b){a.local?d("sendDataStream",{id:a.getID(),msg:b}):L.Logger.error("You can not send data through a remote stream")};b=function(b,f,n){var l="http://"+b.host;void 0!==hasPrivateIP&&null!==hasPrivateIP&&(l="http://"+hasPrivateIP);delete io.sockets[l];
a.socket=io.connect(l,{reconnect:!1,secure:!1});a.socket.on("onAddStream",function(b){var c=Erizo.Stream({streamID:b.id,local:!1,audio:b.audio,video:b.video,data:b.data,screen:b.screen,attributes:b.attributes});a.remoteStreams[b.id]=c;b=Erizo.StreamEvent({type:"stream-added",stream:c});a.dispatchEvent(b)});a.socket.on("onSubscribeP2P",function(b){var c=a.localStreams[b.streamId];void 0===c.pc&&(c.pc={});c.pc[b.subsSocket]=Erizo.Connection({callback:function(a){e("publish",{state:"p2pSignaling",streamId:b.streamId,
subsSocket:b.subsSocket},a,function(a){a==="error"&&callbackError&&callbackError(a);c.pc[b.subsSocket].onsignalingmessage=function(){c.pc[b.subsSocket].onsignalingmessage=function(){}};c.pc[b.subsSocket].processSignalingMessage(a)})},audio:c.hasAudio(),video:c.hasVideo(),stunServerUrl:a.stunServerUrl,turnServer:a.turnServer});c.pc[b.subsSocket].addStream(c.stream);c.pc[b.subsSocket].oniceconnectionstatechange=function(a){if(a==="disconnected"){c.pc[b.subsSocket].close();delete c.pc[b.subsSocket]}}});
a.socket.on("onPublishP2P",function(b,d){var g=a.remoteStreams[b.streamId];g.pc=Erizo.Connection({callback:function(){},stunServerUrl:a.stunServerUrl,turnServer:a.turnServer,maxAudioBW:c.maxAudioBW,maxVideoBW:c.maxVideoBW});g.pc.onsignalingmessage=function(a){g.pc.onsignalingmessage=function(){};d(a)};g.pc.processSignalingMessage(b.sdp);g.pc.onaddstream=function(b){L.Logger.info("Stream subscribed");g.stream=b.stream;b=Erizo.StreamEvent({type:"stream-subscribed",stream:g});a.dispatchEvent(b)}});a.socket.on("onDataStream",
function(b){var c=a.remoteStreams[b.id],b=Erizo.StreamEvent({type:"stream-data",msg:b.msg,stream:c});c.dispatchEvent(b)});a.socket.on("onRemoveStream",function(b){var c=a.remoteStreams[b.id];delete a.remoteStreams[b.id];h(c);b=Erizo.StreamEvent({type:"stream-removed",stream:c});a.dispatchEvent(b)});a.socket.on("disconnect",function(){L.Logger.info("Socket disconnected");if(0!==a.state){var b=Erizo.RoomEvent({type:"room-disconnected"});a.dispatchEvent(b)}});d("token",b,f,n)};d=function(b,c,d,e){L.Logger.debug("Send Message - Emit status is "+
a.socket.connected+" for type "+b);a.socket.emit(b,c,function(b,c){L.Logger.debug("Send Message Callback - Emit status is "+a.socket.connected);"success"===b?void 0!==d&&d(c):void 0!==e&&e(c)})};e=function(b,c,d,e){L.Logger.debug("Send SDP - Emit status is "+a.socket.connected+" for type "+b);a.socket.emit(b,c,d,function(b,c){L.Logger.debug("Send SDP Callback - Emit status is "+a.socket.connected);void 0!==e&&e(b,c)})};a.connect=function(){var d=L.Base64.decodeBase64(c.token);0!==a.state&&L.Logger.error("Room already connected");
a.state=1;b(JSON.parse(d),function(b){var d=0,g=[],e,f,h;e=b.streams;a.p2p=b.p2p;f=b.id;a.stunServerUrl=b.stunServerUrl;a.turnServer=b.turnServer;a.state=2;c.defaultVideoBW=b.defaultVideoBW;c.maxVideoBW=b.maxVideoBW;for(d in e)e.hasOwnProperty(d)&&(h=e[d],b=Erizo.Stream({streamID:h.id,local:!1,audio:h.audio,video:h.video,data:h.data,screen:h.screen,attributes:h.attributes}),g.push(b),a.remoteStreams[h.id]=b);a.roomID=f;L.Logger.info("Connected to room "+a.roomID);d=Erizo.RoomEvent({type:"room-connected",
streams:g});a.dispatchEvent(d)},function(a){L.Logger.error("Not Connected! Error: "+a)})};a.disconnect=function(){var b=Erizo.RoomEvent({type:"room-disconnected"});a.dispatchEvent(b)};a.publish=function(b,d,n,l){d=d||{};d.maxVideoBW=d.maxVideoBW||c.defaultVideoBW;d.maxVideoBW>c.maxVideoBW&&(d.maxVideoBW=c.maxVideoBW);b.local&&void 0===a.localStreams[b.getID()]&&(b.hasAudio()||b.hasVideo()||b.hasScreen()?void 0!==b.url?e("publish",{state:"url",data:b.hasData(),audio:b.hasAudio(),video:b.hasVideo(),
attributes:b.getAttributes()},b.url,function(c,d){if(c==="success"){L.Logger.info("Stream published");b.getID=function(){return d};b.sendData=function(a){f(b,a)};a.localStreams[d]=b;b.room=a;n&&n()}else{L.Logger.info("Error when publishing the stream",c);l&&l(c)}}):a.p2p?(c.maxAudioBW=d.maxAudioBW,c.maxVideoBW=d.maxVideoBW,e("publish",{state:"p2p",data:b.hasData(),audio:b.hasAudio(),video:b.hasVideo(),screen:b.hasScreen(),attributes:b.getAttributes()},void 0,function(c,d){c==="error"&&l&&l(c);L.Logger.info("Stream published");
b.getID=function(){return d};if(b.hasData())b.sendData=function(a){f(b,a)};a.localStreams[d]=b;b.room=a})):(b.pc=Erizo.Connection({callback:function(c){e("publish",{state:"offer",data:b.hasData(),audio:b.hasAudio(),video:b.hasVideo(),attributes:b.getAttributes()},c,function(c,d){if(c==="error")l&&l(c);else{b.pc.onsignalingmessage=function(c){b.pc.onsignalingmessage=function(){};e("publish",{state:"ok",streamId:d,data:b.hasData(),audio:b.hasAudio(),video:b.hasVideo(),screen:b.hasScreen(),attributes:b.getAttributes()},
c);L.Logger.info("Stream published");b.getID=function(){return d};if(b.hasData())b.sendData=function(a){f(b,a)};a.localStreams[d]=b;b.room=a;n&&n()};b.pc.processSignalingMessage(c)}})},stunServerUrl:a.stunServerUrl,turnServer:a.turnServer,maxAudioBW:d.maxAudioBW,maxVideoBW:d.maxVideoBW}),b.pc.addStream(b.stream)):b.hasData()&&e("publish",{state:"data",data:b.hasData(),audio:!1,video:!1,screen:!1,attributes:b.getAttributes()},void 0,function(c,d){if(c==="error")l&&l(c);else{L.Logger.info("Stream published");
b.getID=function(){return d};b.sendData=function(a){f(b,a)};a.localStreams[d]=b;b.room=a}}))};a.record=function(a,b,c,e,f,h,o){L.Logger.debug("Start Recording "+b+"in room "+c);d("startRecorder",{to:a.getID(),name:b,room:c,resW:e,resH:f},h,o)};a.stoprecord=function(a,b,c){d("stopRecorder",{to:a.getID()},b,c)};a.unpublish=function(b){if(b.local){d("unpublish",b.getID());b.room=void 0;if((b.hasAudio()||b.hasVideo()||b.hasScreen())&&void 0===b.url)b.pc.close(),b.pc=void 0,b.showOverlay();delete a.localStreams[b.getID()];
b.getID=function(){};b.sendData=function(){}}};a.ask4FIR=function(a){e("askFir",{streamId:a.getID()})};a.subscribe=function(b,c,d){c=c||{};if(!b.local){if(b.hasVideo()||b.hasAudio()||b.hasScreen())a.p2p?e("subscribe",{streamId:b.getID()}):(b.pc=Erizo.Connection({callback:function(a){e("subscribe",{streamId:b.getID(),audio:c.audio,video:c.video,data:c.data},a,function(a){"error"===a?d&&d(a):(a.match(/a=ssrc:55543/)&&(a=a.replace(/a=sendrecv\\r\\na=mid:video/,"a=recvonly\\r\\na=mid:video"),a=a.split("a=ssrc:55543")[0]+
'"}'),b.pc.processSignalingMessage(a))})},nop2p:!0,audio:b.hasAudio(),video:b.hasVideo(),videostunServerUrl:a.stunServerUrl,turnServer:a.turnServer}),b.pc.onaddstream=function(c){L.Logger.info("Stream subscribed");b.stream=c.stream;c=Erizo.StreamEvent({type:"stream-subscribed",stream:b});a.dispatchEvent(c)});else if(b.hasData()&&!1!==c.data)e("subscribe",{streamId:b.getID(),data:c.data},void 0,function(c){"error"===c?d&&d(c):(L.Logger.info("Stream subscribed"),c=Erizo.StreamEvent({type:"stream-subscribed",
stream:b}),a.dispatchEvent(c))});else{L.Logger.info("Subscribing to anything");return}L.Logger.info("Subscribing to: "+b.getID())}};a.unsubscribe=function(b,c){void 0!==a.socket&&(b.local||d("unsubscribe",b.getID(),function(){"error"===answer?c&&c(answer):h(b)},function(){L.Logger.error("Error calling unsubscribe.")}))};a.getStreamsByAttribute=function(b,c){var d=[],e,f;for(e in a.remoteStreams)a.remoteStreams.hasOwnProperty(e)&&(f=a.remoteStreams[e],void 0!==f.getAttributes()&&void 0!==f.getAttributes()[b]&&
f.getAttributes()[b]===c&&d.push(f));return d};return a};var L=L||{};
L.Logger=function(c){return{DEBUG:0,TRACE:1,INFO:2,WARNING:3,ERROR:4,NONE:5,enableLogPanel:function(){c.Logger.panel=document.createElement("textarea");c.Logger.panel.setAttribute("id","licode-logs");c.Logger.panel.setAttribute("style","width: 100%; height: 100%; display: none");c.Logger.panel.setAttribute("rows",20);c.Logger.panel.setAttribute("cols",20);c.Logger.panel.setAttribute("readOnly",!0);document.body.appendChild(c.Logger.panel)},setLogLevel:function(a){a>c.Logger.NONE?a=c.Logger.NONE:a<
c.Logger.DEBUG&&(a=c.Logger.DEBUG);c.Logger.logLevel=a},log:function(a){var b="";if(!(a<c.Logger.logLevel)){a===c.Logger.DEBUG?b+="DEBUG":a===c.Logger.TRACE?b+="TRACE":a===c.Logger.INFO?b+="INFO":a===c.Logger.WARNING?b+="WARNING":a===c.Logger.ERROR&&(b+="ERROR");for(var b=b+": ",d=[],e=0;e<arguments.length;e++)d[e]=arguments[e];d=d.slice(1);d=[b].concat(d);if(void 0!==c.Logger.panel){b="";for(e=0;e<d.length;e++)b+=d[e];c.Logger.panel.value=c.Logger.panel.value+"\n"+b}else console.log.apply(console,
d)}},debug:function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];c.Logger.log.apply(c.Logger,[c.Logger.DEBUG].concat(a))},trace:function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];c.Logger.log.apply(c.Logger,[c.Logger.TRACE].concat(a))},info:function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];c.Logger.log.apply(c.Logger,[c.Logger.INFO].concat(a))},warning:function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];c.Logger.log.apply(c.Logger,
[c.Logger.WARNING].concat(a))},error:function(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];c.Logger.log.apply(c.Logger,[c.Logger.ERROR].concat(a))}}}(L);L=L||{};
L.Base64=function(){var c,a,b,d,e,f,h,g,i;c="A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,0,1,2,3,4,5,6,7,8,9,+,/".split(",");a=[];for(e=0;e<c.length;e+=1)a[c[e]]=e;f=function(a){b=a;d=0};h=function(){var a;if(!b||d>=b.length)return-1;a=b.charCodeAt(d)&255;d+=1;return a};g=function(){if(!b)return-1;for(;;){if(d>=b.length)return-1;var c=b.charAt(d);d+=1;if(a[c])return a[c];if("A"===c)return 0}};i=function(a){a=a.toString(16);1===a.length&&(a=
"0"+a);return unescape("%"+a)};return{encodeBase64:function(a){var b,d,e;f(a);a="";b=Array(3);d=0;for(e=!1;!e&&-1!==(b[0]=h());)if(b[1]=h(),b[2]=h(),a+=c[b[0]>>2],-1!==b[1]?(a+=c[b[0]<<4&48|b[1]>>4],-1!==b[2]?(a+=c[b[1]<<2&60|b[2]>>6],a+=c[b[2]&63]):(a+=c[b[1]<<2&60],a+="=",e=!0)):(a+=c[b[0]<<4&48],a+="=",a+="=",e=!0),d+=4,76<=d)a+="\n",d=0;return a},decodeBase64:function(a){var b,c;f(a);a="";b=Array(4);for(c=!1;!c&&-1!==(b[0]=g())&&-1!==(b[1]=g());)b[2]=g(),b[3]=g(),a+=i(b[0]<<2&255|b[1]>>4),-1!==
b[2]?(a+=i(b[1]<<4&255|b[2]>>2),-1!==b[3]?a+=i(b[2]<<6&255|b[3]):c=!0):c=!0;return a}}}(L);Erizo=Erizo||{};Erizo.View=function(){var c=Erizo.EventDispatcher({});c.url="http://chotis2.dit.upm.es:3000";return c};Erizo=Erizo||{};
Erizo.VideoPlayer=function(c){var a=Erizo.View({});a.id=c.id;a.stream=c.stream.stream;a.elementID=c.elementID;a.destroy=function(){a.video.pause();clearInterval(a.resize);a.parentNode.removeChild(a.div)};L.Logger.debug("Creating URL from stream "+a.stream);a.stream_url=(URL||webkitURL||mozURL||msURL).createObjectURL(a.stream);a.div=document.createElement("div");a.div.setAttribute("id","player_"+a.id);a.div.setAttribute("style","width: 100%; height: 100%; position: relative; background-color: black; overflow: hidden;");a.overlay=
document.createElement("div");a.overlay.setAttribute("id","overlay_"+a.id);a.overlay.setAttribute("class","overlayVideo");textWarning=document.createTextNode(not_pub_yet);a.loader=document.createElement("img");a.loader.setAttribute("style","width: 16px; height: 16px; position: absolute; top: 50%; left: 50%; margin-top: -8px; margin-left: -8px");a.loader.setAttribute("id","back_"+a.id);a.loader.setAttribute("src",a.url+"/assets/loader.gif");a.video=document.createElement("video");a.video.setAttribute("id",
"stream"+a.id);a.video.setAttribute("style","width: 100%; height: 100%; position: absolute");a.video.setAttribute("autoplay","autoplay");c.stream.local&&(a.video.volume=0);c.stream.local&&(a.video.volume=0);void 0!==a.elementID?(document.getElementById(a.elementID).appendChild(a.div),a.container=document.getElementById(a.elementID)):(document.body.appendChild(a.div),a.container=document.body);a.parentNode=a.div.parentNode;a.div.appendChild(a.loader);a.div.appendChild(a.overlay);a.overlay.appendChild(textWarning);
a.div.appendChild(a.video);a.containerWidth=0;a.containerHeight=0;a.resize=setInterval(function(){var b=a.container.offsetWidth,d=a.container.offsetHeight;if(c.stream.screen)if(b*0.75<d){a.video.style.width=b+"px";a.video.style.height=0.75*b+"px";a.video.style.top=-(0.75*b/2-d/2)+"px";a.video.style.left="0px"}else{a.video.style.height=d+"px";a.video.style.width=4/3*d+"px";a.video.style.left=-(4/3*d/2-b/2)+"px";a.video.style.top="0px"}else if(b!==a.containerWidth||d!==a.containerHeight)if(b*0.75>d){a.video.style.width=
b+"px";a.video.style.height=0.75*b+"px";a.video.style.top=-(0.75*b/2-d/2)+"px";a.video.style.left="0px"}else{a.video.style.height=d+"px";a.video.style.width=4/3*d+"px";a.video.style.left=-(4/3*d/2-b/2)+"px";a.video.style.top="0px"}a.containerWidth=b;a.containerHeight=d},500);a.showOverlay=function(){L.Logger.debug("Displaying overlay for "+a.stream);document.getElementById("overlay_"+a.id).style.display="block"};a.hideOverlay=function(){L.Logger.debug("Hiding overlay for "+a.id);document.getElementById("overlay_"+
a.id).style.display="none"};a.bar=new Erizo.Bar({elementID:"player_"+a.id,id:a.id,stream:c.stream,media:a.video,options:c.options});a.div.onmouseover=function(){a.bar.display()};a.div.onmouseout=function(){a.bar.hide()};a.video.src=a.stream_url;return a};Erizo=Erizo||{};
Erizo.AudioPlayer=function(c){var a=Erizo.View({}),b,d;a.id=c.id;a.stream=c.stream.stream;a.elementID=c.elementID;L.Logger.debug("Creating URL from stream "+a.stream);a.stream_url=(window.URL||webkitURL).createObjectURL(a.stream);a.audio=document.createElement("audio");a.audio.setAttribute("id","stream"+a.id);a.audio.setAttribute("style","width: 100%; height: 100%; position: absolute");a.audio.setAttribute("autoplay","autoplay");c.stream.local&&(a.audio.volume=0);c.stream.local&&(a.audio.volume=0);
void 0!==a.elementID?(a.destroy=function(){a.audio.pause();a.parentNode.removeChild(a.div)},b=function(){a.bar.display()},d=function(){a.bar.hide()},a.div=document.createElement("div"),a.div.setAttribute("id","player_"+a.id),a.div.setAttribute("style","width: 100%; height: 100%; position: relative; overflow: hidden;"),document.getElementById(a.elementID).appendChild(a.div),a.container=document.getElementById(a.elementID),a.parentNode=a.div.parentNode,a.div.appendChild(a.audio),a.bar=new Erizo.Bar({elementID:"player_"+
a.id,id:a.id,stream:c.stream,media:a.audio,options:c.options}),a.div.onmouseover=b,a.div.onmouseout=d):(a.destroy=function(){a.audio.pause();a.parentNode.removeChild(a.audio)},document.body.appendChild(a.audio),a.parentNode=document.body);a.audio.src=a.stream_url;return a};Erizo=Erizo||{};
Erizo.Bar=function(c){var a=Erizo.View({}),b,d;a.elementID=c.elementID;a.id=c.id;a.div=document.createElement("div");a.div.setAttribute("id","bar_"+a.id);a.bar=document.createElement("div");a.bar.setAttribute("style","width: 100%; height: 15%; max-height: 30px; position: absolute; bottom: 0; right: 0; background-color: rgba(255,255,255,0.62)");a.bar.setAttribute("id","subbar_"+a.id);a.link=document.createElement("a");a.link.setAttribute("href","http://www.lynckia.com/");a.link.setAttribute("target","_blank");
a.logo=document.createElement("img");a.logo.setAttribute("style","width: 100%; height: 100%; max-width: 30px; position: absolute; top: 0; left: 2px;");a.logo.setAttribute("alt","Lynckia");a.logo.setAttribute("src",a.url+"/assets/star.svg");d=function(c){"block"!==c?c="none":clearTimeout(b);a.div.setAttribute("style","width: 100%; height: 100%; position: relative; bottom: 0; right: 0; display:"+c)};a.display=function(){d("block")};a.hide=function(){b=setTimeout(d,1E3)};document.getElementById(a.elementID).appendChild(a.div);
a.div.appendChild(a.bar);a.bar.appendChild(a.link);a.link.appendChild(a.logo);if(!c.stream.screen&&(void 0===c.options||void 0===c.options.speaker||!0===c.options.speaker))a.speaker=new Erizo.Speaker({elementID:"subbar_"+a.id,id:a.id,stream:c.stream,media:c.media});a.display();a.hide();return a};Erizo=Erizo||{};
Erizo.Speaker=function(c){var a=Erizo.View({}),b,d,e,f=50,h=!1;a.elementID=c.elementID;a.media=c.media;a.id=c.id;a.stream=c.stream;a.div=document.createElement("div");a.div.setAttribute("style","width: 40%; height: 100%; max-width: 32px; position: absolute; right: 0;z-index:0;");a.icon=document.createElement("img");a.icon.setAttribute("id","volume_"+a.id);a.icon.setAttribute("src",a.url+"/assets/sound48.png");a.icon.setAttribute("style","width: 80%; height: 100%; position: absolute;");a.div.appendChild(a.icon);
a.stream.local?(d=function(){h=!0;a.icon.setAttribute("src",a.url+"/assets/mute48.png");a.stream.stream.getAudioTracks()[0].enabled=!1},e=function(){h=!1;a.icon.setAttribute("src",a.url+"/assets/sound48.png");a.stream.stream.getAudioTracks()[0].enabled=!0},a.icon.onclick=function(){h?e():d()}):(a.picker=document.createElement("input"),a.picker.setAttribute("id","picker_"+a.id),a.picker.type="range",a.picker.min=0,a.picker.max=100,a.picker.step=10,a.picker.value=f,a.div.appendChild(a.picker),a.media.volume=
a.picker.value/100,a.picker.oninput=function(){0<a.picker.value?(h=!1,a.icon.setAttribute("src",a.url+"/assets/sound48.png")):(h=!0,a.icon.setAttribute("src",a.url+"/assets/mute48.png"));a.media.volume=a.picker.value/100},b=function(b){a.picker.setAttribute("style","width: 32px; height: 100px; position: absolute; bottom: 90%; z-index: 1;"+a.div.offsetHeight+"px; right: 0px; -webkit-appearance: slider-vertical; display: "+b)},d=function(){h=!0;a.icon.setAttribute("src",a.url+"/assets/mute48.png");
f=a.picker.value;a.picker.value=0;a.media.volume=0},e=function(){h=!1;a.icon.setAttribute("src",a.url+"/assets/sound48.png");a.picker.value=f;a.media.volume=a.picker.value/100},a.icon.onclick=function(){h?e():d()},a.div.onmouseover=function(){b("block")},a.div.onmouseout=function(){b("none")},b("none"));document.getElementById(a.elementID).appendChild(a.div);return a};
